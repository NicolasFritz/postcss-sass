"use strict";

var postcss = require('postcss');

var gonzales = require('gonzales-pe');

var DEFAULT_RAWS_ROOT = {
  before: ''
};
var DEFAULT_RAWS_RULE = {
  before: '',
  between: ''
};
var DEFAULT_RAWS_DECL = {
  before: '',
  between: '',
  semicolon: false
};
var DEFAULT_COMMENT_DECL = {
  before: ''
};

var SassParser = /*#__PURE__*/function () {
  function SassParser(input) {
    this.input = input;
  }

  var _proto = SassParser.prototype;

  _proto.parse = function parse() {
    try {
      this.node = gonzales.parse(this.input.css, {
        syntax: 'sass'
      });
    } catch (error) {
      throw this.input.error(error.message, error.line, 1);
    }

    this.lines = this.input.css.match(/^.*(\r?\n|$)/gm);
    this.root = this.stylesheet(this.node);
  };

  _proto.extractSource = function extractSource(start, end) {
    var nodeLines = this.lines.slice(start.line - 1, end.line);
    nodeLines[0] = nodeLines[0].substring(start.column - 1);
    var last = nodeLines.length - 1;
    nodeLines[last] = nodeLines[last].substring(0, end.column);
    return nodeLines.join('');
  };

  _proto.stylesheet = function stylesheet(node) {
    var _this = this;

    // Create and set parameters for Root node
    var root = postcss.root();
    root.source = {
      start: node.start,
      end: node.end,
      input: this.input
    }; // Raws for root node

    root.raws = {
      semicolon: DEFAULT_RAWS_ROOT.semicolon,
      before: DEFAULT_RAWS_ROOT.before
    }; // Store spaces before root (if exist)

    this.raws = {
      before: ''
    };
    node.content.forEach(function (contentNode) {
      return _this.process(contentNode, root);
    });
    return root;
  };

  _proto.process = function process(node, parent) {
    if (this[node.type]) return this[node.type](node, parent) || null;
    return null;
  };

  _proto.ruleset = function ruleset(node, parent) {
    var _this2 = this;

    // Loop to find the deepest ruleset node
    this.raws.multiRuleProp = '';
    node.content.forEach(function (contentNode) {
      switch (contentNode.type) {
        case 'block':
          {
            // Create Rule node
            var rule = postcss.rule();
            rule.selector = ''; // Object to store raws for Rule

            var ruleRaws = {
              before: _this2.raws.before || DEFAULT_RAWS_RULE.before,
              between: DEFAULT_RAWS_RULE.between
            }; // Variable to store spaces and symbols before declaration property

            _this2.raws.before = '';
            _this2.raws.comment = false; // Look up throw all nodes in current ruleset node

            node.content.filter(function (content) {
              return content.type === 'block';
            }).forEach(function (innerContentNode) {
              return _this2.process(innerContentNode, rule);
            });

            if (rule.nodes.length) {
              // Write selector to Rule
              rule.selector = _this2.extractSource(node.start, contentNode.start).slice(0, -1).replace(/\s+$/, function (spaces) {
                ruleRaws.between = spaces;
                return '';
              }); // Set parameters for Rule node

              rule.parent = parent;
              rule.source = {
                start: node.start,
                end: node.end,
                input: _this2.input
              };
              rule.raws = ruleRaws;
              parent.nodes.push(rule);
            }

            break;
          }

        default:
      }
    });
  };

  _proto.block = function block(node, parent) {
    var _this3 = this;

    // If nested rules exist, wrap current rule in new rule node
    if (this.raws.multiRule) {
      if (this.raws.multiRulePropVariable) {
        this.raws.multiRuleProp = "$" + this.raws.multiRuleProp;
      }

      var multiRule = Object.assign(postcss.rule(), {
        source: {
          start: {
            line: node.start.line - 1,
            column: node.start.column
          },
          end: node.end,
          input: this.input
        },
        raws: {
          before: this.raws.before || DEFAULT_RAWS_RULE.before,
          between: DEFAULT_RAWS_RULE.between
        },
        parent: parent,
        selector: (this.raws.customProperty ? '--' : '') + this.raws.multiRuleProp
      });
      parent.push(multiRule);
      parent = multiRule;
    }

    this.raws.before = ''; // Looking for declaration node in block node

    node.content.forEach(function (contentNode) {
      return _this3.process(contentNode, parent);
    });

    if (this.raws.multiRule) {
      this.raws.beforeMulti = this.raws.before;
    }
  };

  _proto.declaration = function declaration(node, parent) {
    var _this4 = this;

    var isBlockInside = false; // Create Declaration node

    var declarationNode = postcss.decl();
    declarationNode.prop = ''; // Object to store raws for Declaration

    var declarationRaws = Object.assign(declarationNode.raws, {
      before: this.raws.before || DEFAULT_RAWS_DECL.before,
      between: DEFAULT_RAWS_DECL.between,
      semicolon: DEFAULT_RAWS_DECL.semicolon
    });
    this.raws.property = false;
    this.raws.betweenBefore = false;
    this.raws.comment = false; // Looking for property and value node in declaration node

    node.content.forEach(function (contentNode) {
      switch (contentNode.type) {
        case 'customProperty':
          _this4.raws.customProperty = true;
        // fall through

        case 'property':
          {
            /* this.raws.property to detect is property is already defined in current object */
            _this4.raws.property = true;
            _this4.raws.multiRuleProp = contentNode.content[0].content;
            _this4.raws.multiRulePropVariable = contentNode.content[0].type === 'variable';

            _this4.process(contentNode, declarationNode);

            break;
          }

        case 'propertyDelimiter':
          {
            if (_this4.raws.property && !_this4.raws.betweenBefore) {
              /* If property is already defined and there's no ':' before it */
              declarationRaws.between += contentNode.content;
              _this4.raws.multiRuleProp += contentNode.content;
            } else {
              /* If ':' goes before property declaration, like :width 100px */
              _this4.raws.betweenBefore = true;
              declarationRaws.before += contentNode.content;
              _this4.raws.multiRuleProp += contentNode.content;
            }

            break;
          }

        case 'space':
          {
            declarationRaws.between += contentNode.content;
            break;
          }

        case 'value':
          {
            // Look up for a value for current property
            switch (contentNode.content[0].type) {
              case 'block':
                {
                  isBlockInside = true; // If nested rules exist

                  if (Array.isArray(contentNode.content[0].content)) {
                    _this4.raws.multiRule = true;
                  }

                  _this4.process(contentNode.content[0], parent);

                  break;
                }

              case 'variable':
                {
                  declarationNode.value = '$';

                  _this4.process(contentNode, declarationNode);

                  break;
                }

              case 'color':
                {
                  declarationNode.value = '#';

                  _this4.process(contentNode, declarationNode);

                  break;
                }

              case 'number':
                {
                  if (contentNode.content.length > 1) {
                    declarationNode.value = contentNode.content.join('');
                  } else {
                    _this4.process(contentNode, declarationNode);
                  }

                  break;
                }

              case 'parentheses':
                {
                  declarationNode.value = '(';

                  _this4.process(contentNode, declarationNode);

                  break;
                }

              default:
                {
                  _this4.process(contentNode, declarationNode);
                }
            }

            break;
          }

        default:
      }
    });

    if (!isBlockInside) {
      // Set parameters for Declaration node
      declarationNode.source = {
        start: node.start,
        end: node.end,
        input: this.input
      };
      declarationNode.parent = parent;
      parent.nodes.push(declarationNode);
    }

    this.raws.before = '';
    this.raws.customProperty = false;
    this.raws.multiRuleProp = '';
    this.raws.property = false;
  };

  _proto.customProperty = function customProperty(node, parent) {
    this.property(node, parent);
    parent.prop = "--" + parent.prop;
  };

  _proto.property = function property(node, parent) {
    // Set property for Declaration node
    switch (node.content[0].type) {
      case 'variable':
        {
          parent.prop += '$';
          break;
        }

      case 'interpolation':
        {
          this.raws.interpolation = true;
          parent.prop += '#{';
          break;
        }

      default:
    }

    parent.prop += node.content[0].content;

    if (this.raws.interpolation) {
      parent.prop += '}';
      this.raws.interpolation = false;
    }
  };

  _proto.value = function value(node, parent) {
    if (!parent.value) {
      parent.value = '';
    } // Set value for Declaration node


    if (node.content.length) {
      node.content.forEach(function (contentNode) {
        switch (contentNode.type) {
          case 'important':
            {
              parent.raws.important = contentNode.content;
              parent.important = true;
              var match = parent.value.match(/^(.*?)(\s*)$/);

              if (match) {
                parent.raws.important = match[2] + parent.raws.important;
                parent.value = match[1];
              }

              break;
            }

          case 'parentheses':
            {
              parent.value += contentNode.content.join('') + ')';
              break;
            }

          case 'percentage':
            {
              parent.value += contentNode.content.join('') + '%';
              break;
            }

          default:
            {
              if (contentNode.content.constructor === Array) {
                parent.value += contentNode.content.join('');
              } else {
                parent.value += contentNode.content;
              }
            }
        }
      });
    }
  };

  _proto.singlelineComment = function singlelineComment(node, parent) {
    return this.comment(node, parent, true);
  };

  _proto.multilineComment = function multilineComment(node, parent) {
    return this.comment(node, parent, false);
  };

  _proto.comment = function comment(node, parent, inline) {
    // https://github.com/nodesecurity/eslint-plugin-security#detect-unsafe-regex
    // eslint-disable-next-line security/detect-unsafe-regex
    var text = node.content.match(/^(\s*)((?:\S[\S\s]*?)?)(\s*)$/);
    this.raws.comment = true;
    var comment = Object.assign(postcss.comment(), {
      text: text[2],
      raws: {
        before: this.raws.before || DEFAULT_COMMENT_DECL.before,
        left: text[1],
        right: text[3],
        inline: inline
      },
      source: {
        start: {
          line: node.start.line,
          column: node.start.column
        },
        end: node.end,
        input: this.input
      },
      parent: parent
    });

    if (this.raws.beforeMulti) {
      comment.raws.before += this.raws.beforeMulti;
      this.raws.beforeMulti = undefined;
    }

    parent.nodes.push(comment);
    this.raws.before = '';
  };

  _proto.space = function space(node, parent) {
    // Spaces before root and rule
    switch (parent.type) {
      case 'root':
        {
          this.raws.before += node.content;
          break;
        }

      case 'rule':
        {
          if (this.raws.comment) {
            this.raws.before += node.content;
          } else if (this.raws.loop) {
            parent.selector += node.content;
          } else {
            this.raws.before = (this.raws.before || '\n') + node.content;
          }

          break;
        }

      default:
    }
  };

  _proto.declarationDelimiter = function declarationDelimiter(node) {
    this.raws.before += node.content;
  };

  _proto.loop = function loop(node, parent) {};

  _proto.atrule = function atrule(node, parent) {};

  _proto.parentheses = function parentheses(node, parent) {
    parent.selector += '(';
    node.content.forEach(function (contentNode) {
      if (typeof contentNode.content === 'string') {
        parent.selector += contentNode.content;
      }

      if (typeof contentNode.content === 'object') {
        contentNode.content.forEach(function (childrenContentNode) {
          if (contentNode.type === 'variable') parent.selector += '$';
          parent.selector += childrenContentNode.content;
        });
      }
    });
    parent.selector += ')';
  };

  _proto.interpolation = function interpolation(node, parent) {
    var _this5 = this;

    parent.selector += '#{';
    node.content.forEach(function (contentNode) {
      _this5.process(contentNode, parent);
    });
    parent.selector += '}';
  };

  _proto.atkeyword = function atkeyword(node, parent) {
    parent.selector += "@" + node.content;
  };

  _proto.operator = function operator(node, parent) {
    parent.selector += node.content;
  };

  _proto.variable = function variable(node, parent) {
    if (this.raws.loop) {
      parent.selector += "$" + node.content[0].content;
      return;
    }

    parent.selector += "$" + node.content;
  };

  _proto.ident = function ident(node, parent) {
    parent.selector += node.content;
  };

  return SassParser;
}();

module.exports = SassParser;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInBhcnNlci5lczYiXSwibmFtZXMiOlsicG9zdGNzcyIsInJlcXVpcmUiLCJnb256YWxlcyIsIkRFRkFVTFRfUkFXU19ST09UIiwiYmVmb3JlIiwiREVGQVVMVF9SQVdTX1JVTEUiLCJiZXR3ZWVuIiwiREVGQVVMVF9SQVdTX0RFQ0wiLCJzZW1pY29sb24iLCJERUZBVUxUX0NPTU1FTlRfREVDTCIsIlNhc3NQYXJzZXIiLCJpbnB1dCIsInBhcnNlIiwibm9kZSIsImNzcyIsInN5bnRheCIsImVycm9yIiwibWVzc2FnZSIsImxpbmUiLCJsaW5lcyIsIm1hdGNoIiwicm9vdCIsInN0eWxlc2hlZXQiLCJleHRyYWN0U291cmNlIiwic3RhcnQiLCJlbmQiLCJub2RlTGluZXMiLCJzbGljZSIsInN1YnN0cmluZyIsImNvbHVtbiIsImxhc3QiLCJsZW5ndGgiLCJqb2luIiwic291cmNlIiwicmF3cyIsImNvbnRlbnQiLCJmb3JFYWNoIiwiY29udGVudE5vZGUiLCJwcm9jZXNzIiwicGFyZW50IiwidHlwZSIsInJ1bGVzZXQiLCJtdWx0aVJ1bGVQcm9wIiwicnVsZSIsInNlbGVjdG9yIiwicnVsZVJhd3MiLCJjb21tZW50IiwiZmlsdGVyIiwiaW5uZXJDb250ZW50Tm9kZSIsIm5vZGVzIiwicmVwbGFjZSIsInNwYWNlcyIsInB1c2giLCJibG9jayIsIm11bHRpUnVsZSIsIm11bHRpUnVsZVByb3BWYXJpYWJsZSIsIk9iamVjdCIsImFzc2lnbiIsImN1c3RvbVByb3BlcnR5IiwiYmVmb3JlTXVsdGkiLCJkZWNsYXJhdGlvbiIsImlzQmxvY2tJbnNpZGUiLCJkZWNsYXJhdGlvbk5vZGUiLCJkZWNsIiwicHJvcCIsImRlY2xhcmF0aW9uUmF3cyIsInByb3BlcnR5IiwiYmV0d2VlbkJlZm9yZSIsIkFycmF5IiwiaXNBcnJheSIsInZhbHVlIiwiaW50ZXJwb2xhdGlvbiIsImltcG9ydGFudCIsImNvbnN0cnVjdG9yIiwic2luZ2xlbGluZUNvbW1lbnQiLCJtdWx0aWxpbmVDb21tZW50IiwiaW5saW5lIiwidGV4dCIsImxlZnQiLCJyaWdodCIsInVuZGVmaW5lZCIsInNwYWNlIiwibG9vcCIsImRlY2xhcmF0aW9uRGVsaW1pdGVyIiwiYXRydWxlIiwicGFyZW50aGVzZXMiLCJjaGlsZHJlbkNvbnRlbnROb2RlIiwiYXRrZXl3b3JkIiwib3BlcmF0b3IiLCJ2YXJpYWJsZSIsImlkZW50IiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxJQUFNQSxPQUFPLEdBQUdDLE9BQU8sQ0FBQyxTQUFELENBQXZCOztBQUNBLElBQU1DLFFBQVEsR0FBR0QsT0FBTyxDQUFDLGFBQUQsQ0FBeEI7O0FBRUEsSUFBTUUsaUJBQWlCLEdBQUc7QUFDdEJDLEVBQUFBLE1BQU0sRUFBRTtBQURjLENBQTFCO0FBSUEsSUFBTUMsaUJBQWlCLEdBQUc7QUFDdEJELEVBQUFBLE1BQU0sRUFBRSxFQURjO0FBRXRCRSxFQUFBQSxPQUFPLEVBQUU7QUFGYSxDQUExQjtBQUtBLElBQU1DLGlCQUFpQixHQUFHO0FBQ3RCSCxFQUFBQSxNQUFNLEVBQUUsRUFEYztBQUV0QkUsRUFBQUEsT0FBTyxFQUFFLEVBRmE7QUFHdEJFLEVBQUFBLFNBQVMsRUFBRTtBQUhXLENBQTFCO0FBTUEsSUFBTUMsb0JBQW9CLEdBQUc7QUFDekJMLEVBQUFBLE1BQU0sRUFBRTtBQURpQixDQUE3Qjs7SUFJTU0sVTtBQUNGLHNCQUFhQyxLQUFiLEVBQW9CO0FBQ2hCLFNBQUtBLEtBQUwsR0FBYUEsS0FBYjtBQUNIOzs7O1NBRURDLEssR0FBQSxpQkFBUztBQUNMLFFBQUk7QUFDQSxXQUFLQyxJQUFMLEdBQVlYLFFBQVEsQ0FBQ1UsS0FBVCxDQUFlLEtBQUtELEtBQUwsQ0FBV0csR0FBMUIsRUFBK0I7QUFBRUMsUUFBQUEsTUFBTSxFQUFFO0FBQVYsT0FBL0IsQ0FBWjtBQUNILEtBRkQsQ0FFRSxPQUFPQyxLQUFQLEVBQWM7QUFDWixZQUFNLEtBQUtMLEtBQUwsQ0FBV0ssS0FBWCxDQUFpQkEsS0FBSyxDQUFDQyxP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WyJjb25zdCBwb3N0Y3NzID0gcmVxdWlyZSgncG9zdGNzcycpXG5jb25zdCBnb256YWxlcyA9IHJlcXVpcmUoJ2dvbnphbGVzLXBlJylcblxuY29uc3QgREVGQVVMVF9SQVdTX1JPT1QgPSB7XG4gICAgYmVmb3JlOiAnJ1xufVxuXG5jb25zdCBERUZBVUxUX1JBV1NfUlVMRSA9IHtcbiAgICBiZWZvcmU6ICcnLFxuICAgIGJldHdlZW46ICcnXG59XG5cbmNvbnN0IERFRkFVTFRfUkFXU19ERUNMID0ge1xuICAgIGJlZm9yZTogJycsXG4gICAgYmV0d2VlbjogJycsXG4gICAgc2VtaWNvbG9uOiBmYWxzZVxufVxuXG5jb25zdCBERUZBVUxUX0NPTU1FTlRfREVDTCA9IHtcbiAgICBiZWZvcmU6ICcnXG59XG5cbmNsYXNzIFNhc3NQYXJzZXIge1xuICAgIGNvbnN0cnVjdG9yIChpbnB1dCkge1xuICAgICAgICB0aGlzLmlucHV0ID0gaW5wdXRcbiAgICB9XG5cbiAgICBwYXJzZSAoKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB0aGlzLm5vZGUgPSBnb256YWxlcy5wYXJzZSh0aGlzLmlucHV0LmNzcywgeyBzeW50YXg6ICdzYXNzJyB9KVxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgdGhyb3cgdGhpcy5pbnB1dC5lcnJvcihlcnJvci5tZXNzYWdlLCBlcnJvci5saW5lLCAxKVxuICAgICAgICB9XG4gICAgICAgIHRoaXMubGluZXMgPSB0aGlzLmlucHV0LmNzcy5tYXRjaCgvXi4qKFxccj9cXG58JCkvZ20pXG4gICAgICAgIHRoaXMucm9vdCA9IHRoaXMuc3R5bGVzaGVldCh0aGlzLm5vZGUpXG4gICAgfVxuXG4gICAgZXh0cmFjdFNvdXJjZSAoc3RhcnQsIGVuZCkge1xuICAgICAgICBsZXQgbm9kZUxpbmVzID0gdGhpcy5saW5lcy5zbGljZShzdGFydC5saW5lIC0gMSwgZW5kLmxpbmUpXG5cbiAgICAgICAgbm9kZUxpbmVzWzBdID0gbm9kZUxpbmVzWzBdLnN1YnN0cmluZyhzdGFydC5jb2x1bW4gLSAxKVxuICAgICAgICBsZXQgbGFzdCA9IG5vZGVMaW5lcy5sZW5ndGggLSAxXG4gICAgICAgIG5vZGVMaW5lc1tsYXN0XSA9IG5vZGVMaW5lc1tsYXN0XS5zdWJzdHJpbmcoMCwgZW5kLmNvbHVtbilcblxuICAgICAgICByZXR1cm4gbm9kZUxpbmVzLmpvaW4oJycpXG4gICAgfVxuXG4gICAgc3R5bGVzaGVldCAobm9kZSkge1xuICAgICAgICAvLyBDcmVhdGUgYW5kIHNldCBwYXJhbWV0ZXJzIGZvciBSb290IG5vZGVcbiAgICAgICAgbGV0IHJvb3QgPSBwb3N0Y3NzLnJvb3QoKVxuICAgICAgICByb290LnNvdXJjZSA9IHtcbiAgICAgICAgICAgIHN0YXJ0OiBub2RlLnN0YXJ0LFxuICAgICAgICAgICAgZW5kOiBub2RlLmVuZCxcbiAgICAgICAgICAgIGlucHV0OiB0aGlzLmlucHV0XG4gICAgICAgIH1cbiAgICAgICAgLy8gUmF3cyBmb3Igcm9vdCBub2RlXG4gICAgICAgIHJvb3QucmF3cyA9IHtcbiAgICAgICAgICAgIHNlbWljb2xvbjogREVGQVVMVF9SQVdTX1JPT1Quc2VtaWNvbG9uLFxuICAgICAgICAgICAgYmVmb3JlOiBERUZBVUxUX1JBV1NfUk9PVC5iZWZvcmVcbiAgICAgICAgfVxuICAgICAgICAvLyBTdG9yZSBzcGFjZXMgYmVmb3JlIHJvb3QgKGlmIGV4aXN0KVxuICAgICAgICB0aGlzLnJhd3MgPSB7XG4gICAgICAgICAgICBiZWZvcmU6ICcnXG4gICAgICAgIH1cbiAgICAgICAgbm9kZS5jb250ZW50LmZvckVhY2goY29udGVudE5vZGUgPT4gdGhpcy5wcm9jZXNzKGNvbnRlbnROb2RlLCByb290KSlcbiAgICAgICAgcmV0dXJuIHJvb3RcbiAgICB9XG5cbiAgICBwcm9jZXNzIChub2RlLCBwYXJlbnQpIHtcbiAgICAgICAgaWYgKHRoaXNbbm9kZS50eXBlXSkgcmV0dXJuIHRoaXNbbm9kZS50eXBlXShub2RlLCBwYXJlbnQpIHx8IG51bGxcbiAgICAgICAgcmV0dXJuIG51bGxcbiAgICB9XG5cbiAgICBydWxlc2V0IChub2RlLCBwYXJlbnQpIHtcbiAgICAgICAgLy8gTG9vcCB0byBmaW5kIHRoZSBkZWVwZXN0IHJ1bGVzZXQgbm9kZVxuICAgICAgICB0aGlzLnJhd3MubXVsdGlSdWxlUHJvcCA9ICcnXG4gICAgICAgIG5vZGUuY29udGVudC5mb3JFYWNoKGNvbnRlbnROb2RlID0+IHtcbiAgICAgICAgICAgIHN3aXRjaCAoY29udGVudE5vZGUudHlwZSkge1xuICAgICAgICAgICAgICAgIGNhc2UgJ2Jsb2NrJzoge1xuICAgICAgICAgICAgICAgICAgICAvLyBDcmVhdGUgUnVsZSBub2RlXG4gICAgICAgICAgICAgICAgICAgIGxldCBydWxlID0gcG9zdGNzcy5ydWxlKClcbiAgICAgICAgICAgICAgICAgICAgcnVsZS5zZWxlY3RvciA9ICcnXG4gICAgICAgICAgICAgICAgICAgIC8vIE9iamVjdCB0byBzdG9yZSByYXdzIGZvciBSdWxlXG4gICAgICAgICAgICAgICAgICAgIGxldCBydWxlUmF3cyA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJlZm9yZTogdGhpcy5yYXdzLmJlZm9yZSB8fCBERUZBVUxUX1JBV1NfUlVMRS5iZWZvcmUsXG4gICAgICAgICAgICAgICAgICAgICAgICBiZXR3ZWVuOiBERUZBVUxUX1JBV1NfUlVMRS5iZXR3ZWVuXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAvLyBWYXJpYWJsZSB0byBzdG9yZSBzcGFjZXMgYW5kIHN5bWJvbHMgYmVmb3JlIGRlY2xhcmF0aW9uIHByb3BlcnR5XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmF3cy5iZWZvcmUgPSAnJ1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJhd3MuY29tbWVudCA9IGZhbHNlXG5cbiAgICAgICAgICAgICAgICAgICAgLy8gTG9vayB1cCB0aHJvdyBhbGwgbm9kZXMgaW4gY3VycmVudCBydWxlc2V0IG5vZGVcbiAgICAgICAgICAgICAgICAgICAgbm9kZS5jb250ZW50XG4gICAgICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKGNvbnRlbnQgPT4gY29udGVudC50eXBlID09PSAnYmxvY2snKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmZvckVhY2goaW5uZXJDb250ZW50Tm9kZSA9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJvY2Vzcyhpbm5lckNvbnRlbnROb2RlLCBydWxlKVxuICAgICAgICAgICAgICAgICAgICAgICAgKVxuXG4gICAgICAgICAgICAgICAgICAgIGlmIChydWxlLm5vZGVzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gV3JpdGUgc2VsZWN0b3IgdG8gUnVsZVxuICAgICAgICAgICAgICAgICAgICAgICAgcnVsZS5zZWxlY3RvciA9IHRoaXMuZXh0cmFjdFNvdXJjZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlLnN0YXJ0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnROb2RlLnN0YXJ0XG4gICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnNsaWNlKDAsIC0xKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKC9cXHMrJC8sIHNwYWNlcyA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ1bGVSYXdzLmJldHdlZW4gPSBzcGFjZXNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICcnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFNldCBwYXJhbWV0ZXJzIGZvciBSdWxlIG5vZGVcbiAgICAgICAgICAgICAgICAgICAgICAgIHJ1bGUucGFyZW50ID0gcGFyZW50XG4gICAgICAgICAgICAgICAgICAgICAgICBydWxlLnNvdXJjZSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydDogbm9kZS5zdGFydCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQ6IG5vZGUuZW5kLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0OiB0aGlzLmlucHV0XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBydWxlLnJhd3MgPSBydWxlUmF3c1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50Lm5vZGVzLnB1c2gocnVsZSlcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVha1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgIH1cblxuICAgIGJsb2NrIChub2RlLCBwYXJlbnQpIHtcbiAgICAgICAgLy8gSWYgbmVzdGVkIHJ1bGVzIGV4aXN0LCB3cmFwIGN1cnJlbnQgcnVsZSBpbiBuZXcgcnVsZSBub2RlXG4gICAgICAgIGlmICh0aGlzLnJhd3MubXVsdGlSdWxlKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5yYXdzLm11bHRpUnVsZVByb3BWYXJpYWJsZSkge1xuICAgICAgICAgICAgICAgIHRoaXMucmF3cy5tdWx0aVJ1bGVQcm9wID0gYCQke3RoaXMucmF3cy5tdWx0aVJ1bGVQcm9wfWBcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGxldCBtdWx0aVJ1bGUgPSBPYmplY3QuYXNzaWduKHBvc3Rjc3MucnVsZSgpLCB7XG4gICAgICAgICAgICAgICAgc291cmNlOiB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXJ0OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsaW5lOiBub2RlLnN0YXJ0LmxpbmUgLSAxLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29sdW1uOiBub2RlLnN0YXJ0LmNvbHVtblxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBlbmQ6IG5vZGUuZW5kLFxuICAgICAgICAgICAgICAgICAgICBpbnB1dDogdGhpcy5pbnB1dFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgcmF3czoge1xuICAgICAgICAgICAgICAgICAgICBiZWZvcmU6IHRoaXMucmF3cy5iZWZvcmUgfHwgREVGQVVMVF9SQVdTX1JVTEUuYmVmb3JlLFxuICAgICAgICAgICAgICAgICAgICBiZXR3ZWVuOiBERUZBVUxUX1JBV1NfUlVMRS5iZXR3ZWVuXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBwYXJlbnQsXG4gICAgICAgICAgICAgICAgc2VsZWN0b3I6XG4gICAgICAgICAgICAgICAgICAgICh0aGlzLnJhd3MuY3VzdG9tUHJvcGVydHkgPyAnLS0nIDogJycpICtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yYXdzLm11bHRpUnVsZVByb3BcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBwYXJlbnQucHVzaChtdWx0aVJ1bGUpXG4gICAgICAgICAgICBwYXJlbnQgPSBtdWx0aVJ1bGVcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMucmF3cy5iZWZvcmUgPSAnJ1xuXG4gICAgICAgIC8vIExvb2tpbmcgZm9yIGRlY2xhcmF0aW9uIG5vZGUgaW4gYmxvY2sgbm9kZVxuICAgICAgICBub2RlLmNvbnRlbnQuZm9yRWFjaChjb250ZW50Tm9kZSA9PiB0aGlzLnByb2Nlc3MoY29udGVudE5vZGUsIHBhcmVudCkpXG4gICAgICAgIGlmICh0aGlzLnJhd3MubXVsdGlSdWxlKSB7XG4gICAgICAgICAgICB0aGlzLnJhd3MuYmVmb3JlTXVsdGkgPSB0aGlzLnJhd3MuYmVmb3JlXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBkZWNsYXJhdGlvbiAobm9kZSwgcGFyZW50KSB7XG4gICAgICAgIGxldCBpc0Jsb2NrSW5zaWRlID0gZmFsc2VcbiAgICAgICAgLy8gQ3JlYXRlIERlY2xhcmF0aW9uIG5vZGVcbiAgICAgICAgbGV0IGRlY2xhcmF0aW9uTm9kZSA9IHBvc3Rjc3MuZGVjbCgpXG4gICAgICAgIGRlY2xhcmF0aW9uTm9kZS5wcm9wID0gJydcblxuICAgICAgICAvLyBPYmplY3QgdG8gc3RvcmUgcmF3cyBmb3IgRGVjbGFyYXRpb25cbiAgICAgICAgbGV0IGRlY2xhcmF0aW9uUmF3cyA9IE9iamVjdC5hc3NpZ24oZGVjbGFyYXRpb25Ob2RlLnJhd3MsIHtcbiAgICAgICAgICAgIGJlZm9yZTogdGhpcy5yYXdzLmJlZm9yZSB8fCBERUZBVUxUX1JBV1NfREVDTC5iZWZvcmUsXG4gICAgICAgICAgICBiZXR3ZWVuOiBERUZBVUxUX1JBV1NfREVDTC5iZXR3ZWVuLFxuICAgICAgICAgICAgc2VtaWNvbG9uOiBERUZBVUxUX1JBV1NfREVDTC5zZW1pY29sb25cbiAgICAgICAgfSlcblxuICAgICAgICB0aGlzLnJhd3MucHJvcGVydHkgPSBmYWxzZVxuICAgICAgICB0aGlzLnJhd3MuYmV0d2VlbkJlZm9yZSA9IGZhbHNlXG4gICAgICAgIHRoaXMucmF3cy5jb21tZW50ID0gZmFsc2VcbiAgICAgICAgLy8gTG9va2luZyBmb3IgcHJvcGVydHkgYW5kIHZhbHVlIG5vZGUgaW4gZGVjbGFyYXRpb24gbm9kZVxuICAgICAgICBub2RlLmNvbnRlbnQuZm9yRWFjaChjb250ZW50Tm9kZSA9PiB7XG4gICAgICAgICAgICBzd2l0Y2ggKGNvbnRlbnROb2RlLnR5cGUpIHtcbiAgICAgICAgICAgICAgICBjYXNlICdjdXN0b21Qcm9wZXJ0eSc6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmF3cy5jdXN0b21Qcm9wZXJ0eSA9IHRydWVcbiAgICAgICAgICAgICAgICAvLyBmYWxsIHRocm91Z2hcbiAgICAgICAgICAgICAgICBjYXNlICdwcm9wZXJ0eSc6IHtcbiAgICAgICAgICAgICAgICAgICAgLyogdGhpcy5yYXdzLnByb3BlcnR5IHRvIGRldGVjdCBpcyBwcm9wZXJ0eSBpcyBhbHJlYWR5IGRlZmluZWQgaW4gY3VycmVudCBvYmplY3QgKi9cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yYXdzLnByb3BlcnR5ID0gdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJhd3MubXVsdGlSdWxlUHJvcCA9IGNvbnRlbnROb2RlLmNvbnRlbnRbMF0uY29udGVudFxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJhd3MubXVsdGlSdWxlUHJvcFZhcmlhYmxlID1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnROb2RlLmNvbnRlbnRbMF0udHlwZSA9PT0gJ3ZhcmlhYmxlJ1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByb2Nlc3MoY29udGVudE5vZGUsIGRlY2xhcmF0aW9uTm9kZSlcbiAgICAgICAgICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2FzZSAncHJvcGVydHlEZWxpbWl0ZXInOiB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnJhd3MucHJvcGVydHkgJiYgIXRoaXMucmF3cy5iZXR3ZWVuQmVmb3JlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvKiBJZiBwcm9wZXJ0eSBpcyBhbHJlYWR5IGRlZmluZWQgYW5kIHRoZXJlJ3Mgbm8gJzonIGJlZm9yZSBpdCAqL1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVjbGFyYXRpb25SYXdzLmJldHdlZW4gKz0gY29udGVudE5vZGUuY29udGVudFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yYXdzLm11bHRpUnVsZVByb3AgKz0gY29udGVudE5vZGUuY29udGVudFxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgLyogSWYgJzonIGdvZXMgYmVmb3JlIHByb3BlcnR5IGRlY2xhcmF0aW9uLCBsaWtlIDp3aWR0aCAxMDBweCAqL1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yYXdzLmJldHdlZW5CZWZvcmUgPSB0cnVlXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWNsYXJhdGlvblJhd3MuYmVmb3JlICs9IGNvbnRlbnROb2RlLmNvbnRlbnRcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmF3cy5tdWx0aVJ1bGVQcm9wICs9IGNvbnRlbnROb2RlLmNvbnRlbnRcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVha1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXNlICdzcGFjZSc6IHtcbiAgICAgICAgICAgICAgICAgICAgZGVjbGFyYXRpb25SYXdzLmJldHdlZW4gKz0gY29udGVudE5vZGUuY29udGVudFxuICAgICAgICAgICAgICAgICAgICBicmVha1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXNlICd2YWx1ZSc6IHtcbiAgICAgICAgICAgICAgICAgICAgLy8gTG9vayB1cCBmb3IgYSB2YWx1ZSBmb3IgY3VycmVudCBwcm9wZXJ0eVxuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKGNvbnRlbnROb2RlLmNvbnRlbnRbMF0udHlwZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnYmxvY2snOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNCbG9ja0luc2lkZSA9IHRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiBuZXN0ZWQgcnVsZXMgZXhpc3RcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShjb250ZW50Tm9kZS5jb250ZW50WzBdLmNvbnRlbnQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmF3cy5tdWx0aVJ1bGUgPSB0cnVlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJvY2Vzcyhjb250ZW50Tm9kZS5jb250ZW50WzBdLCBwYXJlbnQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3ZhcmlhYmxlJzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlY2xhcmF0aW9uTm9kZS52YWx1ZSA9ICckJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJvY2Vzcyhjb250ZW50Tm9kZSwgZGVjbGFyYXRpb25Ob2RlKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdjb2xvcic6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWNsYXJhdGlvbk5vZGUudmFsdWUgPSAnIydcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByb2Nlc3MoY29udGVudE5vZGUsIGRlY2xhcmF0aW9uTm9kZSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVha1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnbnVtYmVyJzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb250ZW50Tm9kZS5jb250ZW50Lmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVjbGFyYXRpb25Ob2RlLnZhbHVlID0gY29udGVudE5vZGUuY29udGVudC5qb2luKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJydcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJvY2Vzcyhjb250ZW50Tm9kZSwgZGVjbGFyYXRpb25Ob2RlKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVha1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAncGFyZW50aGVzZXMnOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVjbGFyYXRpb25Ob2RlLnZhbHVlID0gJygnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm9jZXNzKGNvbnRlbnROb2RlLCBkZWNsYXJhdGlvbk5vZGUpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByb2Nlc3MoY29udGVudE5vZGUsIGRlY2xhcmF0aW9uTm9kZSlcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVha1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuXG4gICAgICAgIGlmICghaXNCbG9ja0luc2lkZSkge1xuICAgICAgICAgICAgLy8gU2V0IHBhcmFtZXRlcnMgZm9yIERlY2xhcmF0aW9uIG5vZGVcbiAgICAgICAgICAgIGRlY2xhcmF0aW9uTm9kZS5zb3VyY2UgPSB7XG4gICAgICAgICAgICAgICAgc3RhcnQ6IG5vZGUuc3RhcnQsXG4gICAgICAgICAgICAgICAgZW5kOiBub2RlLmVuZCxcbiAgICAgICAgICAgICAgICBpbnB1dDogdGhpcy5pbnB1dFxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZGVjbGFyYXRpb25Ob2RlLnBhcmVudCA9IHBhcmVudFxuICAgICAgICAgICAgcGFyZW50Lm5vZGVzLnB1c2goZGVjbGFyYXRpb25Ob2RlKVxuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5yYXdzLmJlZm9yZSA9ICcnXG4gICAgICAgIHRoaXMucmF3cy5jdXN0b21Qcm9wZXJ0eSA9IGZhbHNlXG4gICAgICAgIHRoaXMucmF3cy5tdWx0aVJ1bGVQcm9wID0gJydcbiAgICAgICAgdGhpcy5yYXdzLnByb3BlcnR5ID0gZmFsc2VcbiAgICB9XG5cbiAgICBjdXN0b21Qcm9wZXJ0eSAobm9kZSwgcGFyZW50KSB7XG4gICAgICAgIHRoaXMucHJvcGVydHkobm9kZSwgcGFyZW50KVxuICAgICAgICBwYXJlbnQucHJvcCA9IGAtLSR7cGFyZW50LnByb3B9YFxuICAgIH1cblxuICAgIHByb3BlcnR5IChub2RlLCBwYXJlbnQpIHtcbiAgICAgICAgLy8gU2V0IHByb3BlcnR5IGZvciBEZWNsYXJhdGlvbiBub2RlXG4gICAgICAgIHN3aXRjaCAobm9kZS5jb250ZW50WzBdLnR5cGUpIHtcbiAgICAgICAgICAgIGNhc2UgJ3ZhcmlhYmxlJzoge1xuICAgICAgICAgICAgICAgIHBhcmVudC5wcm9wICs9ICckJ1xuICAgICAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXNlICdpbnRlcnBvbGF0aW9uJzoge1xuICAgICAgICAgICAgICAgIHRoaXMucmF3cy5pbnRlcnBvbGF0aW9uID0gdHJ1ZVxuICAgICAgICAgICAgICAgIHBhcmVudC5wcm9wICs9ICcjeydcbiAgICAgICAgICAgICAgICBicmVha1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgfVxuICAgICAgICBwYXJlbnQucHJvcCArPSBub2RlLmNvbnRlbnRbMF0uY29udGVudFxuICAgICAgICBpZiAodGhpcy5yYXdzLmludGVycG9sYXRpb24pIHtcbiAgICAgICAgICAgIHBhcmVudC5wcm9wICs9ICd9J1xuICAgICAgICAgICAgdGhpcy5yYXdzLmludGVycG9sYXRpb24gPSBmYWxzZVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgdmFsdWUgKG5vZGUsIHBhcmVudCkge1xuICAgICAgICBpZiAoIXBhcmVudC52YWx1ZSkge1xuICAgICAgICAgICAgcGFyZW50LnZhbHVlID0gJydcbiAgICAgICAgfVxuICAgICAgICAvLyBTZXQgdmFsdWUgZm9yIERlY2xhcmF0aW9uIG5vZGVcbiAgICAgICAgaWYgKG5vZGUuY29udGVudC5sZW5ndGgpIHtcbiAgICAgICAgICAgIG5vZGUuY29udGVudC5mb3JFYWNoKGNvbnRlbnROb2RlID0+IHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKGNvbnRlbnROb2RlLnR5cGUpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnaW1wb3J0YW50Jzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50LnJhd3MuaW1wb3J0YW50ID0gY29udGVudE5vZGUuY29udGVudFxuICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50LmltcG9ydGFudCA9IHRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBtYXRjaCA9IHBhcmVudC52YWx1ZS5tYXRjaCgvXiguKj8pKFxccyopJC8pXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobWF0Y2gpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQucmF3cy5pbXBvcnRhbnQgPVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXRjaFsyXSArIHBhcmVudC5yYXdzLmltcG9ydGFudFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudC52YWx1ZSA9IG1hdGNoWzFdXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVha1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ3BhcmVudGhlc2VzJzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50LnZhbHVlICs9IGNvbnRlbnROb2RlLmNvbnRlbnQuam9pbignJykgKyAnKSdcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY2FzZSAncGVyY2VudGFnZSc6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudC52YWx1ZSArPSBjb250ZW50Tm9kZS5jb250ZW50LmpvaW4oJycpICsgJyUnXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVha1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb250ZW50Tm9kZS5jb250ZW50LmNvbnN0cnVjdG9yID09PSBBcnJheSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudC52YWx1ZSArPSBjb250ZW50Tm9kZS5jb250ZW50LmpvaW4oJycpXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudC52YWx1ZSArPSBjb250ZW50Tm9kZS5jb250ZW50XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgc2luZ2xlbGluZUNvbW1lbnQgKG5vZGUsIHBhcmVudCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jb21tZW50KG5vZGUsIHBhcmVudCwgdHJ1ZSlcbiAgICB9XG5cbiAgICBtdWx0aWxpbmVDb21tZW50IChub2RlLCBwYXJlbnQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29tbWVudChub2RlLCBwYXJlbnQsIGZhbHNlKVxuICAgIH1cblxuICAgIGNvbW1lbnQgKG5vZGUsIHBhcmVudCwgaW5saW5lKSB7XG4gICAgICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9ub2Rlc2VjdXJpdHkvZXNsaW50LXBsdWdpbi1zZWN1cml0eSNkZXRlY3QtdW5zYWZlLXJlZ2V4XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBzZWN1cml0eS9kZXRlY3QtdW5zYWZlLXJlZ2V4XG4gICAgICAgIGxldCB0ZXh0ID0gbm9kZS5jb250ZW50Lm1hdGNoKC9eKFxccyopKCg/OlxcU1tcXFNcXHNdKj8pPykoXFxzKikkLylcblxuICAgICAgICB0aGlzLnJhd3MuY29tbWVudCA9IHRydWVcblxuICAgICAgICBsZXQgY29tbWVudCA9IE9iamVjdC5hc3NpZ24ocG9zdGNzcy5jb21tZW50KCksIHtcbiAgICAgICAgICAgIHRleHQ6IHRleHRbMl0sXG4gICAgICAgICAgICByYXdzOiB7XG4gICAgICAgICAgICAgICAgYmVmb3JlOiB0aGlzLnJhd3MuYmVmb3JlIHx8IERFRkFVTFRfQ09NTUVOVF9ERUNMLmJlZm9yZSxcbiAgICAgICAgICAgICAgICBsZWZ0OiB0ZXh0WzFdLFxuICAgICAgICAgICAgICAgIHJpZ2h0OiB0ZXh0WzNdLFxuICAgICAgICAgICAgICAgIGlubGluZVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNvdXJjZToge1xuICAgICAgICAgICAgICAgIHN0YXJ0OiB7XG4gICAgICAgICAgICAgICAgICAgIGxpbmU6IG5vZGUuc3RhcnQubGluZSxcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uOiBub2RlLnN0YXJ0LmNvbHVtblxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZW5kOiBub2RlLmVuZCxcbiAgICAgICAgICAgICAgICBpbnB1dDogdGhpcy5pbnB1dFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHBhcmVudFxuICAgICAgICB9KVxuXG4gICAgICAgIGlmICh0aGlzLnJhd3MuYmVmb3JlTXVsdGkpIHtcbiAgICAgICAgICAgIGNvbW1lbnQucmF3cy5iZWZvcmUgKz0gdGhpcy5yYXdzLmJlZm9yZU11bHRpXG4gICAgICAgICAgICB0aGlzLnJhd3MuYmVmb3JlTXVsdGkgPSB1bmRlZmluZWRcbiAgICAgICAgfVxuXG4gICAgICAgIHBhcmVudC5ub2Rlcy5wdXNoKGNvbW1lbnQpXG4gICAgICAgIHRoaXMucmF3cy5iZWZvcmUgPSAnJ1xuICAgIH1cblxuICAgIHNwYWNlIChub2RlLCBwYXJlbnQpIHtcbiAgICAgICAgLy8gU3BhY2VzIGJlZm9yZSByb290IGFuZCBydWxlXG4gICAgICAgIHN3aXRjaCAocGFyZW50LnR5cGUpIHtcbiAgICAgICAgICAgIGNhc2UgJ3Jvb3QnOiB7XG4gICAgICAgICAgICAgICAgdGhpcy5yYXdzLmJlZm9yZSArPSBub2RlLmNvbnRlbnRcbiAgICAgICAgICAgICAgICBicmVha1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2FzZSAncnVsZSc6IHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5yYXdzLmNvbW1lbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yYXdzLmJlZm9yZSArPSBub2RlLmNvbnRlbnRcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMucmF3cy5sb29wKSB7XG4gICAgICAgICAgICAgICAgICAgIHBhcmVudC5zZWxlY3RvciArPSBub2RlLmNvbnRlbnRcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJhd3MuYmVmb3JlID0gKHRoaXMucmF3cy5iZWZvcmUgfHwgJ1xcbicpICsgbm9kZS5jb250ZW50XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICB9XG4gICAgfVxuXG4gICAgZGVjbGFyYXRpb25EZWxpbWl0ZXIgKG5vZGUpIHtcbiAgICAgICAgdGhpcy5yYXdzLmJlZm9yZSArPSBub2RlLmNvbnRlbnRcbiAgICB9XG5cbiAgICBsb29wIChub2RlLCBwYXJlbnQpIHtcbiAgICB9XG5cbiAgICBhdHJ1bGUgKG5vZGUsIHBhcmVudCkge1xuICAgIH1cblxuICAgIHBhcmVudGhlc2VzIChub2RlLCBwYXJlbnQpIHtcbiAgICAgICAgcGFyZW50LnNlbGVjdG9yICs9ICcoJ1xuICAgICAgICBub2RlLmNvbnRlbnQuZm9yRWFjaChjb250ZW50Tm9kZSA9PiB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIGNvbnRlbnROb2RlLmNvbnRlbnQgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgcGFyZW50LnNlbGVjdG9yICs9IGNvbnRlbnROb2RlLmNvbnRlbnRcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHR5cGVvZiBjb250ZW50Tm9kZS5jb250ZW50ID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgICAgIGNvbnRlbnROb2RlLmNvbnRlbnQuZm9yRWFjaChjaGlsZHJlbkNvbnRlbnROb2RlID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbnRlbnROb2RlLnR5cGUgPT09ICd2YXJpYWJsZScpIHBhcmVudC5zZWxlY3RvciArPSAnJCdcbiAgICAgICAgICAgICAgICAgICAgcGFyZW50LnNlbGVjdG9yICs9IGNoaWxkcmVuQ29udGVudE5vZGUuY29udGVudFxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICAgIHBhcmVudC5zZWxlY3RvciArPSAnKSdcbiAgICB9XG5cbiAgICBpbnRlcnBvbGF0aW9uIChub2RlLCBwYXJlbnQpIHtcbiAgICAgICAgcGFyZW50LnNlbGVjdG9yICs9ICcjeydcbiAgICAgICAgbm9kZS5jb250ZW50LmZvckVhY2goY29udGVudE5vZGUgPT4ge1xuICAgICAgICAgICAgdGhpcy5wcm9jZXNzKGNvbnRlbnROb2RlLCBwYXJlbnQpXG4gICAgICAgIH0pXG4gICAgICAgIHBhcmVudC5zZWxlY3RvciArPSAnfSdcbiAgICB9XG5cbiAgICBhdGtleXdvcmQgKG5vZGUsIHBhcmVudCkge1xuICAgICAgICBwYXJlbnQuc2VsZWN0b3IgKz0gYEAke25vZGUuY29udGVudH1gXG4gICAgfVxuXG4gICAgb3BlcmF0b3IgKG5vZGUsIHBhcmVudCkge1xuICAgICAgICBwYXJlbnQuc2VsZWN0b3IgKz0gbm9kZS5jb250ZW50XG4gICAgfVxuXG4gICAgdmFyaWFibGUgKG5vZGUsIHBhcmVudCkge1xuICAgICAgICBpZiAodGhpcy5yYXdzLmxvb3ApIHtcbiAgICAgICAgICAgIHBhcmVudC5zZWxlY3RvciArPSBgJCR7bm9kZS5jb250ZW50WzBdLmNvbnRlbnR9YFxuICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgIH1cbiAgICAgICAgcGFyZW50LnNlbGVjdG9yICs9IGAkJHtub2RlLmNvbnRlbnR9YFxuICAgIH1cblxuICAgIGlkZW50IChub2RlLCBwYXJlbnQpIHtcbiAgICAgICAgcGFyZW50LnNlbGVjdG9yICs9IG5vZGUuY29udGVudFxuICAgIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSBTYXNzUGFyc2VyXG4iXX0=